<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Finance</title>

    <meta name = "viewport" content = "width = device-width, initial-scale = 1">      
    <link rel = "stylesheet" href = "https://fonts.googleapis.com/icon?family=Material+Icons">
    <link rel = "stylesheet" href = "https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.3/css/materialize.min.css">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>          
    <script src = "https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.3/js/materialize.min.js"></script>
 

<script>
    
    $(function(){
        
        $(document).ready(function() {
            $('select').material_select();

            function calculateTotal()
            {
            
            //item_price.sugar = ($("#autocomplete-quantite").val() * $("#autocomplete-prix").val() )
            var prixHT = ($("#quantite").val() * $("#prix").val() - $("#reduction").val() )
            $("#total_ht").val(prixHT);
            var prixTTC =  prixHT + (prixHT * ($("#tva").val() / 100))
            $("#total_ttc").val(prixTTC);
            }
            $(function()
            {
                $(".autocomplete").on("change keyup",calculateTotal)
            })
  }); // end of document ready
})(jQuery); 



</script>


</head>

<body>
<!--
Client (destinataire),
Duree de validité (exemple calendrier ou bare),
Arcticle : quantité, prix, tva, réduction, total HT, total TTC, description
Possibilité d'ajouter des articles 
-->

<nav>
    <div class="nav-wrapper teal lighten-1">
        <a href="#!" class="brand-logo"><p class="material-icons">calculate</p>FINANCES</a>
        <ul class="right hide-on-med-and-down">
            <li><a href="./"><i class="material-icons">home</i></a></li>
            <li><a href="./dashboard"><i class="material-icons">insert_chart</i></a></li>
            <li><a href=""><i class="material-icons">refresh</i></a></li>
            <li><a><i class="material-icons">more_vert</i></a></li>
        </ul>
    </div>
</nav>

<div class="container">
    
    <h3>Nouveau devis</h3>
    <div class="row">
        <div class="col s12">
            <form action="/creer_devis" method="POST">
                <div class="row">
                    <div class="input-field col s12">
                        <select name="selectClient" id="selectClient">
                            <option value="" disabled selected>Sélectionner un destinataire</option>
                            <% devis.forEach(function(devi) {%>
                            <option name="nomClient" value="<%= devi.client %>"><%= devi.client %></option>
                            <% }); %>
                        </select>
                        <label for="selectClient">Destinataire</label>
                    </div>
                </div>
                <h5>Informations</h5>
                <div class="row">
                    <div class="input-field col s12">
                        <label for="date_val">Durée de validité</label>
                        <br>
                        <input type="date" id="date_val" name="date_val" class="datepicker" required>
                    </div>
                </div>
                <h5>Articles</h5>
                <div class="row">
                    <div class="input-field col s2">
                        <input type="number" min="0" id="quantite"  name="quantite" class="autocomplete" required>
                        <label for="quantite">Quantité</label>
                    </div>
                    <div class="input-field col s2">
                        <input type="number" min="0" id="prix"  name="prix" class="autocomplete" required>
                        <label for="prix">Prix (€)</label>
                    </div>
                    <div class="input-field col s2">
                        <input value="20" min="0" type="number" id="tva"  name="tva" class="autocomplete" required>
                        <label class="active" for="tva">TVA (%)</label>
                    </div>
                    <div class="input-field col s2">
                        <input type="number" min="0" id="reduction"  name="reduction" class="autocomplete" >
                        <label for="reduction">Réduction (€)</label>
                    </div><div class="input-field col s2">
                        <input type="number" min="0" readonly value="0" id="total_ht"  name="total_ht" class="autocomplete" required>
                        <label for="total_ht">Total HT (€)</label>
                    </div>
                    <div class="input-field col s2">
                        <input type="number" min="0" readonly value="0" id="total_ttc"  name="total_ttc" class="autocomplete" required>
                        <label for="total_ttc">Total TTC (€)</label>
                    </div>
                    <div class="input-field col s12">          
                        <textarea id="description" name="description" class="materialize-textarea" required></textarea>
                        <label for="description">Description</label>
                    </div>
                </div>
                <button class="btn waves-effect waves-light" type="submit" name="action">Submit
                    <i class="material-icons right">send</i>
                </button>
            </form>
        </div>
    </div>
 
    <!--<input type="text" id="autocomplete-input"  name="nomClient" class="autocomplete" >-->
    <!--<label for="autocomplete-input">Autocomplete</label>-->

   <!---->

    <!--<div>-->
        <!--<form action="#">-->
            <!--<p class="range-field">-->
                <!--<input type="range" id="test5" min="0" max="100" />-->
            <!--</p>-->
        <!--</form>-->
    <!--</div>-->
</div>

</body>
</html>
